{"ast":null,"code":"import _regeneratorRuntime from\"C:/React/Chapter 3/music-player/react-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/React/Chapter 3/music-player/react-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:/React/Chapter 3/music-player/react-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/React/Chapter 3/music-player/react-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useRef}from\"react\";//Adding Components\nimport Player from\"./components/Player\";import Song from\"./components/Song\";import Library from\"./components/Library\";import Nav from\"./components/Nav\";//Add css\nimport\"./styles/app.scss\";//Import Util\nimport data from\"./data\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){//Ref\nvar audioRef=useRef(null);//State\nvar _useState=useState(data()),_useState2=_slicedToArray(_useState,2),songs=_useState2[0],setSongs=_useState2[1];var _useState3=useState(songs[0]),_useState4=_slicedToArray(_useState3,2),currentSong=_useState4[0],setCurrentSong=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isPlaying=_useState6[0],setIsPlaying=_useState6[1];var _useState7=useState({currentTime:0,duration:0,animationPercentage:0}),_useState8=_slicedToArray(_useState7,2),songInfo=_useState8[0],setSongInfo=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),libraryStatus=_useState10[0],setLibraryStatus=_useState10[1];var timeUpdateHandler=function timeUpdateHandler(e){var current=e.target.currentTime;var duration=e.target.duration;//Calc %\nvar roundedCurrent=Math.round(current);var roundedDuration=Math.round(duration);var animationPercentage=Math.round(roundedCurrent/roundedDuration*100);setSongInfo(_objectSpread(_objectSpread({},songInfo),{},{currentTime:current,duration:duration,animationPercentage:animationPercentage}));};var activeLibraryHandler=function activeLibraryHandler(nextPrev){var newSongs=songs.map(function(song){if(song.id===nextPrev.id){return _objectSpread(_objectSpread({},song),{},{active:true});}else{return _objectSpread(_objectSpread({},song),{},{active:false});}});setSongs(newSongs);};var songEndHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var currentIndex;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:currentIndex=songs.findIndex(function(song){return song.id===currentSong.id;});_context.next=3;return setCurrentSong(songs[(currentIndex+1)%songs.length]);case 3:activeLibraryHandler(songs[(currentIndex+1)%songs.length]);if(isPlaying)audioRef.current.play();case 5:case\"end\":return _context.stop();}}},_callee);}));return function songEndHandler(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"App \".concat(libraryStatus?\"library-active\":\"\"),children:[/*#__PURE__*/_jsx(Nav,{libraryStatus:libraryStatus,setLibraryStatus:setLibraryStatus}),/*#__PURE__*/_jsx(Song,{currentSong:currentSong}),/*#__PURE__*/_jsx(Player,{setIsPlaying:setIsPlaying,isPlaying:isPlaying,currentSong:currentSong,audioRef:audioRef,setSongInfo:setSongInfo,songInfo:songInfo,songs:songs,setCurrentSong:setCurrentSong,setSongs:setSongs}),/*#__PURE__*/_jsx(Library,{songs:songs,setCurrentSong:setCurrentSong,audioRef:audioRef,isPlaying:isPlaying,setSongs:setSongs,libraryStatus:libraryStatus}),/*#__PURE__*/_jsx(\"audio\",{onTimeUpdate:timeUpdateHandler,onLoadedMetadata:timeUpdateHandler,ref:audioRef,src:currentSong.audio,onEnded:songEndHandler})]});}export default App;","map":{"version":3,"sources":["C:/React/Chapter 3/music-player/react-player/src/App.js"],"names":["React","useState","useRef","Player","Song","Library","Nav","data","App","audioRef","songs","setSongs","currentSong","setCurrentSong","isPlaying","setIsPlaying","currentTime","duration","animationPercentage","songInfo","setSongInfo","libraryStatus","setLibraryStatus","timeUpdateHandler","e","current","target","roundedCurrent","Math","round","roundedDuration","activeLibraryHandler","nextPrev","newSongs","map","song","id","active","songEndHandler","currentIndex","findIndex","length","play","audio"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from \"react\";\n//Adding Components\nimport Player from \"./components/Player\";\nimport Song from \"./components/Song\";\nimport Library from \"./components/Library\";\nimport Nav from \"./components/Nav\";\n//Add css\nimport \"./styles/app.scss\";\n//Import Util\nimport data from \"./data\";\n\nfunction App() {\n  //Ref\n  const audioRef = useRef(null);\n  //State\n  const [songs, setSongs] = useState(data());\n  const [currentSong, setCurrentSong] = useState(songs[0]);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [songInfo, setSongInfo] = useState({\n    currentTime: 0,\n    duration: 0,\n    animationPercentage: 0,\n  });\n  const [libraryStatus, setLibraryStatus] = useState(false);\n  const timeUpdateHandler = (e) => {\n    const current = e.target.currentTime;\n    const duration = e.target.duration;\n    //Calc %\n    const roundedCurrent = Math.round(current);\n    const roundedDuration = Math.round(duration);\n    const animationPercentage = Math.round(\n      (roundedCurrent / roundedDuration) * 100\n    );\n    setSongInfo({\n      ...songInfo,\n      currentTime: current,\n      duration,\n      animationPercentage,\n    });\n  };\n  const activeLibraryHandler = (nextPrev) => {\n    const newSongs = songs.map((song) => {\n      if (song.id === nextPrev.id) {\n        return {\n          ...song,\n          active: true,\n        };\n      } else {\n        return {\n          ...song,\n          active: false,\n        };\n      }\n    });\n    setSongs(newSongs);\n  };\n  const songEndHandler = async () => {\n    let currentIndex = songs.findIndex((song) => song.id === currentSong.id);\n    await setCurrentSong(songs[(currentIndex + 1) % songs.length]);\n    activeLibraryHandler(songs[(currentIndex + 1) % songs.length]);\n    if (isPlaying) audioRef.current.play();\n  };\n  return (\n    <div className={`App ${libraryStatus ? \"library-active\" : \"\"}`}>\n      <Nav libraryStatus={libraryStatus} setLibraryStatus={setLibraryStatus} />\n      <Song currentSong={currentSong} />\n      <Player\n        setIsPlaying={setIsPlaying}\n        isPlaying={isPlaying}\n        currentSong={currentSong}\n        audioRef={audioRef}\n        setSongInfo={setSongInfo}\n        songInfo={songInfo}\n        songs={songs}\n        setCurrentSong={setCurrentSong}\n        setSongs={setSongs}\n      />\n      <Library\n        songs={songs}\n        setCurrentSong={setCurrentSong}\n        audioRef={audioRef}\n        isPlaying={isPlaying}\n        setSongs={setSongs}\n        libraryStatus={libraryStatus}\n      />\n      <audio\n        onTimeUpdate={timeUpdateHandler}\n        onLoadedMetadata={timeUpdateHandler}\n        ref={audioRef}\n        src={currentSong.audio}\n        onEnded={songEndHandler}\n      ></audio>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}